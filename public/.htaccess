# Disable specific ModSecurity rules (try both syntaxes)
<IfModule mod_security.c>
  SecRuleRemoveById 400011
  SecRuleRemoveById 400012
  SecRuleRemoveById 920170
</IfModule>

<IfModule mod_security2.c>
  SecRuleRemoveById 400011
  SecRuleRemoveById 400012
  SecRuleRemoveById 920170
</IfModule>

# Public webroot .htaccess
Options -Indexes
ServerSignature Off
<IfModule mod_headers.c>
  Header always set X-Content-Type-Options "nosniff"
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set X-XSS-Protection "1; mode=block"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>
<IfModule mod_rewrite.c>
  RewriteEngine On
  
  # POST-only access to contact-handler.php
  RewriteCond %{REQUEST_URI} ^/contact-handler\.php$ [NC]
  RewriteCond %{REQUEST_METHOD} !POST
  RewriteRule ^ - [F]
  
  # Explicitly allow contact-handler.php to be handled by PHP (no SPA rewrite)
  RewriteRule ^contact-handler\.php$ - [L]
  
  # Serve existing files/directories directly
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  
  # React SPA Fallback
  RewriteRule ^ index.html [L]
</IfModule>